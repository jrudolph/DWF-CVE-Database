{
    "data_version": "4.0",
    "references": {
        "reference_data": "http://www.vapidlabs.com/advisory.php?v=191"
    },
    "description": {
        "description_data": "Unauthenticated Stored XSS Vulnerability in Wordpress plugin gift-certificate-creator v1.0"
    },
    "data_type": "CVE",
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "n/a",
                                            "version_affected": "1.0"
                                        }
                                    ]
                                },
                                "product_name": "n/a"
                            }
                        ]
                    },
                    "vendor_name": "Bob Cares https://bobcares.com/"
                }
            ]
        }
    },
    "CVE_data_meta": {
        "UPDATED": "2017-08-10T14:41Z",
        "CVE_product_name": "https://wordpress.org/plugins/gift-certificate-creator/",
        "ASSIGNER": "larry0@me.com",
        "STATE": "PUBLIC",
        "REQUESTER": "kurt@seifried.org",
        "ID": "CVE-2017-1002017",
        "DATE_ASSIGNED": "2017-05-15"
    },
    "data_format": "MITRE",
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "EN",
                        "value": "Publically accessible pages that are using the shortcode \u2018[gift_certificate_form]\u2019 allow any user to add gift certificate entries into the database.  These entries are listed by the Wordpress administrator when visiting the plugin admin page.  This action is performed by gc-list.php which doesn't sanitize the entries before\r\ndisplaying them.   This allows malicious javascript to be injected into the WordPress database. \r\n\r\n\r\nIn file giftcertificates.php \r\n141:    if ($_REQUEST['action'] == 'Submit') {\r\n144:        //if (!empty($_REQUEST['cert_amount']) && !empty($_REQUEST['cc_number']) && !empty($_REQUEST['cc_sec_code'])) {\r\n145:   \t\tif (!empty($_REQUEST['cert_amount']) && !empty($_REQUEST['cc_sec_code'])) {\r\n147:       $gcmObj->createNewGCM($_REQUEST);\r\n149:            writeLog(" amount ".$_REQUEST['cert_amount']." and email ".$_REQUEST['cc_sec_code']." are posted successfully", basename(__LINE__), basename(__FILE__));\r\n152:            $gcmObj->sendGCMReportEmail(GC_MAIL_TO, GC_MAIL_FROM, GC_MAIL_SUBJECT, $_REQUEST);\r\n153:            $_REQUEST = array();\r\n212-    <form method="get" name="gc_form" action="">\r\n213-        <table class='gc_form'>\r\n214-            <tr>\r\n215-                <th>Certificate Amount:</th>\r\n216:                <td><input type="text" name="cert_amount" value="<?php echo $_REQUEST['cert_amount']; ?>" placeholder ="$"></td>\r\n217-            </tr>\r\n218-            <tr>\r\n219-                <th>Your Name:</th>\r\n220:                <td><input type="text" name="user_name" value="<?php echo $_REQUEST['user_name']; ?>"> (optional)</td>\r\n221-            </tr>\r\n222-            <tr>\r\n223-     <th>Recipient Name:</th>\r\n224:                <td><input type="text" name="receip_name" value="<?php echo $_REQUEST['receip_name']; ?>"> (optional)</td>\r\n225-            </tr>\r\n226-            <tr>\r\n227-                <th>Recipient Email:</th>\r\n228:                <td><input type="text" name="cc_sec_code" value="<?php echo $_REQUEST['cc_sec_code']; ?>"></td>\r\n229-  </tr>\r\n230-            <tr>\r\n231-                <th>Recipient Address:</th>\r\n232:                <td><textarea name="receip_address" value="<?php echo $_REQUEST['receip_address']; ?>"></textarea>\r\n233-            </tr>\r\n234-            <tr>\r\n235-                <td colspan="2" style="text-align: center;"><input type="submit" value="Submit" name="action"></td>\r\n236-  </tr>\r\n237-        </table>\r\n\r\n"
                    }
                ]
            }
        ]
    }
}
